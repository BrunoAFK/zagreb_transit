<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Zagreb Transit for Home Assistant: setup, sensors and usage." />
  <title>Zagreb Transit — Balanced</title>
  <script>
    (function(){const t=localStorage.getItem('zt_theme_balanced');const d=t?t==='dark':window.matchMedia('(prefers-color-scheme: dark)').matches;document.documentElement.classList.toggle('dark',d)})();
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config={darkMode:'class',theme:{extend:{fontFamily:{sans:['Space Grotesk','sans-serif']},keyframes:{fadeUp:{'0%':{opacity:'0',transform:'translateY(14px)'},'100%':{opacity:'1',transform:'translateY(0)'}}},animation:{fadeUp:'fadeUp .65s ease forwards'}}}}
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet" />
</head>
<body class="h-full font-sans bg-slate-100 text-slate-900 dark:bg-slate-950 dark:text-slate-100">
  <div class="min-h-full bg-gradient-to-b from-emerald-100/40 to-cyan-100/20 dark:from-emerald-900/10 dark:to-cyan-900/10">
    <main class="mx-auto max-w-6xl px-6 py-8">
      <header class="flex flex-wrap items-center justify-between gap-4">
        <div>
          <p class="text-xs uppercase tracking-[0.2em] text-slate-500">Home Assistant</p>
          <h1 class="text-3xl font-bold">Zagreb Transit</h1>
        </div>
        <div class="flex gap-3">
          <a href="https://github.com/BrunoAFK/ZagrebTransport" target="_blank" rel="noopener" class="rounded-full border border-slate-300 bg-white/80 px-4 py-2 text-sm dark:border-slate-700 dark:bg-slate-900/60">GitHub ★ <span id="stars">—</span></a>
          <button id="theme" class="rounded-full border border-slate-300 bg-white/80 px-4 py-2 text-sm dark:border-slate-700 dark:bg-slate-900/60">Dark / Light</button>
        </div>
      </header>

      <section class="mt-8 rounded-3xl border border-white/70 bg-white/70 p-8 shadow-lg backdrop-blur dark:border-slate-700/70 dark:bg-slate-900/60 animate-fadeUp">
        <h2 class="text-5xl font-bold leading-tight">GTFS + realtime + dynamic watches for Zagreb transit.</h2>
        <p class="mt-4 max-w-3xl text-slate-600 dark:text-slate-300">Purpose: provide dependable transit entities that can drive Lovelace cards, alerts, and automations in Home Assistant.</p>
      </section>

      <section class="mt-6 grid gap-4 lg:grid-cols-2">
        <article class="rounded-2xl border border-slate-200 bg-white/80 p-6 dark:border-slate-800 dark:bg-slate-900/60 animate-fadeUp" style="animation-delay:.08s">
          <h3 class="text-xl font-semibold">Installation</h3>
          <h4 class="mt-4 font-semibold">HACS</h4>
          <ol class="mt-2 list-decimal pl-5 text-sm text-slate-600 dark:text-slate-300 space-y-1">
            <li>HACS → Integrations → Custom repositories.</li>
            <li>Add repository as <code>Integration</code>.</li>
            <li>Install <code>Zagreb Transit</code>.</li>
            <li>Restart HA and add integration.</li>
          </ol>
          <h4 class="mt-4 font-semibold">Manual</h4>
          <ol class="mt-2 list-decimal pl-5 text-sm text-slate-600 dark:text-slate-300 space-y-1">
            <li>Copy <code>custom_components/zagreb_transit</code>.</li>
            <li>Restart HA.</li>
            <li>Add integration in Devices & Services.</li>
          </ol>
        </article>

        <article class="rounded-2xl border border-slate-200 bg-white/80 p-6 dark:border-slate-800 dark:bg-slate-900/60 animate-fadeUp" style="animation-delay:.16s">
          <h3 class="text-xl font-semibold">How It Works (detailed)</h3>
          <ol class="mt-3 list-decimal pl-5 text-sm text-slate-700 dark:text-slate-300 space-y-2">
            <li>Static GTFS feed is loaded and versioned.</li>
            <li>Realtime polling enriches departures where available.</li>
            <li>Core entities expose feed and realtime health.</li>
            <li>Board/query entities return nearby, station-direction and OD results.</li>
            <li>Optional watch lifecycle (add/edit/remove) creates dynamic sensors.</li>
            <li>Registry sensor tracks all watches and entity mapping.</li>
          </ol>
        </article>
      </section>

      <section class="mt-6 grid gap-4 lg:grid-cols-2">
        <article class="rounded-2xl border border-slate-200 bg-white/80 p-6 dark:border-slate-800 dark:bg-slate-900/60 animate-fadeUp" style="animation-delay:.24s">
          <h3 class="text-xl font-semibold">Sensors</h3>
          <div class="mt-3 grid gap-3 sm:grid-cols-2 text-sm">
            <div class="rounded-xl bg-slate-100 p-3 dark:bg-slate-800">
              <p class="font-semibold">Core health</p>
              <ul class="mt-2 space-y-1 text-slate-600 dark:text-slate-300">
                <li><code>sensor.zagreb_transport_feed_version_active</code></li>
                <li><code>sensor.zagreb_transport_feed_source</code></li>
                <li><code>sensor.zagreb_transport_realtime_status</code></li>
              </ul>
            </div>
            <div class="rounded-xl bg-slate-100 p-3 dark:bg-slate-800">
              <p class="font-semibold">Boards and results</p>
              <ul class="mt-2 space-y-1 text-slate-600 dark:text-slate-300">
                <li><code>sensor.zagreb_transport_nearby_board</code></li>
                <li><code>sensor.zagreb_transport_station_direction_board</code></li>
                <li><code>sensor.zagreb_transport_next_trip_od_do</code></li>
              </ul>
            </div>
          </div>
          <p class="mt-3 text-sm text-slate-600 dark:text-slate-300">Watch entity pattern: <code>sensor.zagreb_transport_watch_&lt;name_slug&gt;</code></p>
        </article>

        <article class="rounded-2xl border border-slate-200 bg-white/80 p-6 dark:border-slate-800 dark:bg-slate-900/60 animate-fadeUp" style="animation-delay:.32s">
          <h3 class="text-xl font-semibold">How To Use</h3>
          <h4 class="mt-3 font-semibold">Quick mode (no watches)</h4>
          <ol class="mt-2 list-decimal pl-5 text-sm text-slate-600 dark:text-slate-300 space-y-1">
            <li>Install integration.</li>
            <li>Validate health sensors.</li>
            <li>Use core controls/selects for ad-hoc board/OD queries.</li>
          </ol>
          <h4 class="mt-4 font-semibold">Watch mode</h4>
          <ol class="mt-2 list-decimal pl-5 text-sm text-slate-600 dark:text-slate-300 space-y-1">
            <li>Configure → Add watch.</li>
            <li>Pick type: <code>station_query</code>, <code>departure</code>, <code>route/od</code>, <code>nearby</code>.</li>
            <li>Name it and verify generated sensor.</li>
            <li>Use that sensor in dashboard/automation.</li>
          </ol>
        </article>
      </section>
    </main>
  </div>

  <script>
    document.getElementById('theme').addEventListener('click',()=>{const h=document.documentElement;const d=!h.classList.contains('dark');h.classList.toggle('dark',d);localStorage.setItem('zt_theme_balanced',d?'dark':'light')});
    (async()=>{try{const r=await fetch('https://api.github.com/repos/BrunoAFK/ZagrebTransport');const d=await r.json();document.getElementById('stars').textContent=(d.stargazers_count??'—').toLocaleString?.()??'—'}catch{}})();
  </script>
</body>
</html>
