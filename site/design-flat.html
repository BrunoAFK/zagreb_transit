<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Zagreb Transit for Home Assistant: GTFS + realtime + watch sensors." />
  <title>Zagreb Transit — Flat Minimal</title>
  <script>
    (function(){const t=localStorage.getItem('zt_theme_flat');const d=t?t==='dark':window.matchMedia('(prefers-color-scheme: dark)').matches;document.documentElement.classList.toggle('dark',d)})();
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config={darkMode:'class',theme:{extend:{fontFamily:{sans:['Space Grotesk','sans-serif']}}}}</script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet" />
</head>
<body class="h-full bg-white text-slate-900 dark:bg-slate-950 dark:text-slate-100 font-sans">
  <main class="mx-auto max-w-5xl px-6 py-10">
    <header class="flex flex-wrap items-center justify-between gap-4 border-b border-slate-200 pb-6 dark:border-slate-800">
      <div>
        <p class="text-xs uppercase tracking-[0.22em] text-slate-500">Home Assistant Integration</p>
        <h1 class="mt-2 text-3xl font-bold">Zagreb Transit</h1>
      </div>
      <div class="flex items-center gap-3">
        <a href="https://github.com/BrunoAFK/ZagrebTransport" target="_blank" rel="noopener" class="inline-flex items-center gap-2 rounded-md border border-slate-300 px-3 py-2 text-sm dark:border-slate-700">
          <span>GitHub</span><span>★</span><span id="stars">—</span>
        </a>
        <button id="theme" class="rounded-md border border-slate-300 px-3 py-2 text-sm dark:border-slate-700">Dark / Light</button>
      </div>
    </header>

    <section class="py-10">
      <h2 class="text-4xl font-bold leading-tight">Realtime public transit data for Zagreb.</h2>
      <p class="mt-4 max-w-3xl text-slate-600 dark:text-slate-300">Zagreb Transit combines static GTFS schedule data with realtime updates and exposes reliable entities for dashboards and automations in Home Assistant.</p>
    </section>

    <section class="space-y-8">
      <article>
        <h3 class="text-2xl font-semibold">Installation</h3>
        <div class="mt-4 grid gap-4 sm:grid-cols-2">
          <div class="rounded-md border border-slate-200 p-4 dark:border-slate-800">
            <h4 class="font-semibold">HACS (recommended)</h4>
            <ol class="mt-2 list-decimal space-y-1 pl-5 text-sm text-slate-600 dark:text-slate-300">
              <li>HACS → Integrations → Custom repositories.</li>
              <li>Add repository as category <code>Integration</code>.</li>
              <li>Install <code>Zagreb Transit</code>.</li>
              <li>Restart Home Assistant.</li>
              <li>Add integration in Devices & Services.</li>
            </ol>
          </div>
          <div class="rounded-md border border-slate-200 p-4 dark:border-slate-800">
            <h4 class="font-semibold">Manual</h4>
            <ol class="mt-2 list-decimal space-y-1 pl-5 text-sm text-slate-600 dark:text-slate-300">
              <li>Copy <code>custom_components/zagreb_transit</code> to HA config.</li>
              <li>Restart Home Assistant.</li>
              <li>Add <code>Zagreb Transit</code> integration.</li>
            </ol>
          </div>
        </div>
      </article>

      <article>
        <h3 class="text-2xl font-semibold">How It Works</h3>
        <ol class="mt-3 list-decimal space-y-2 pl-5 text-sm text-slate-700 dark:text-slate-300">
          <li>Integration loads static GTFS feed and stores active feed metadata.</li>
          <li>Realtime layer refreshes vehicle/departure signals and tracks feed status.</li>
          <li>Core board entities are available immediately (nearby board, station-direction board, OD next trip).</li>
          <li>Optional dynamic watches create persistent sensors for your chosen scenarios.</li>
          <li>Registry entity tracks all watches and mapping to generated entity IDs.</li>
          <li>Dashboards/automations consume entities like any standard HA sensor.</li>
        </ol>
      </article>

      <article>
        <h3 class="text-2xl font-semibold">Sensors & Entities</h3>
        <div class="mt-4 grid gap-4 sm:grid-cols-2">
          <div class="rounded-md border border-slate-200 p-4 dark:border-slate-800">
            <h4 class="font-semibold">Core Health</h4>
            <ul class="mt-2 space-y-1 text-sm text-slate-600 dark:text-slate-300">
              <li><code>sensor.zagreb_transport_feed_version_active</code></li>
              <li><code>sensor.zagreb_transport_feed_source</code></li>
              <li><code>sensor.zagreb_transport_realtime_status</code></li>
              <li><code>sensor.zagreb_transport_watch_registry</code></li>
            </ul>
          </div>
          <div class="rounded-md border border-slate-200 p-4 dark:border-slate-800">
            <h4 class="font-semibold">Boards & Queries</h4>
            <ul class="mt-2 space-y-1 text-sm text-slate-600 dark:text-slate-300">
              <li><code>sensor.zagreb_transport_nearby_board</code></li>
              <li><code>sensor.zagreb_transport_station_direction_board</code></li>
              <li><code>sensor.zagreb_transport_next_trip_od_do</code></li>
              <li><code>sensor.zagreb_transport_watch_&lt;name_slug&gt;</code></li>
            </ul>
          </div>
        </div>
      </article>

      <article>
        <h3 class="text-2xl font-semibold">How To Use</h3>
        <div class="mt-4 grid gap-4 sm:grid-cols-2">
          <div class="rounded-md border border-slate-200 p-4 dark:border-slate-800">
            <h4 class="font-semibold">Without Watches (quick mode)</h4>
            <ol class="mt-2 list-decimal space-y-1 pl-5 text-sm text-slate-600 dark:text-slate-300">
              <li>Install and add integration.</li>
              <li>Check core health sensors.</li>
              <li>Use built-in controls/selects for manual route or board queries.</li>
              <li>Read outputs from core board sensors.</li>
            </ol>
          </div>
          <div class="rounded-md border border-slate-200 p-4 dark:border-slate-800">
            <h4 class="font-semibold">With Watches (advanced mode)</h4>
            <ol class="mt-2 list-decimal space-y-1 pl-5 text-sm text-slate-600 dark:text-slate-300">
              <li>Configure → Add watch.</li>
              <li>Pick type: <code>station_query</code>, <code>departure</code>, <code>route(od)</code>, <code>nearby</code>.</li>
              <li>Name watch clearly.</li>
              <li>Use generated sensor in dashboard/automation.</li>
            </ol>
          </div>
        </div>
      </article>
    </section>
  </main>

  <script>
    document.getElementById('theme').addEventListener('click',()=>{const h=document.documentElement;const d=!h.classList.contains('dark');h.classList.toggle('dark',d);localStorage.setItem('zt_theme_flat',d?'dark':'light')});
    (async()=>{try{const r=await fetch('https://api.github.com/repos/BrunoAFK/ZagrebTransport');const d=await r.json();document.getElementById('stars').textContent=(d.stargazers_count??'—').toLocaleString?.()??'—'}catch{}})();
  </script>
</body>
</html>
